import React from "react";
import {
  // useSprings,
  interpolate,
  // useSpring,
  animated,
  // config,
} from "react-spring";
// import styles from "./Masterswitch.module.scss";
import styles from "./SceneIcon.module.scss";
import { calcDir } from "../common/helpers";
import { requestSender } from "../../../lib/js/helpers/network";

const onClickRequest = async (parentName, scene) => {
  const data = {
    room: {
      name: "" + parentName,
      scene: "" + scene,
    },
  };
  try {
    return requestSender("rooms/set-room", data).then(res => res.json());
  } catch (error) {
    console.log("TCL: onClickRequest -> error", error);
  }
};

const SceneIcon = props => {
  const {
    cords,
    containerSize,
    number,
    text,
    numberOfChilds,
    parentName,
    // zIndex,
  } = props;
  // console.log("TCL: text", text);

  const translateInter = interpolate(
    [
      cords.interpolate({
        map: Math.abs,
        range: [0, 100],
        // output: ["scale(1,1)", "scale(1,-1)"],
        // output: [0, divSize.current[0]],
        output: [0, containerSize[0]],
        extrapolate: "clamp",
      }),
    ],
    // y => calcDir(number, y)
    y => calcDir(number, y, numberOfChilds)
  );

  function handleClick(e) {
    e.stopPropagation();
    onClickRequest(parentName, text);
  }

  return (
    <animated.figure
      // ref={divRef}
      className={styles.sceneIcon}
      style={{
        transform: translateInter,
        opacity: cords.interpolate(c => c / 100),
        // zIndex: zIndex,
      }}
      onMouseDown={e => e.stopPropagation()}
      onTouchStart={e => e.stopPropagation()}
      onClick={handleClick}
    >
      <svg
        width="512"
        height="512"
        enableBackground="new 0 0 501.986 501.986"
        version="1.1"
        viewBox="0 0 501.99 501.99"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path d="m224.35 6v35.83c0 3.314 2.686 6 6 6s6-2.686 6-6v-35.83c0-3.314-2.686-6-6-6s-6 2.686-6 6z" />
        <path d="m361 182.73h35.83c3.314 0 6-2.686 6-6s-2.686-6-6-6h-35.83c-3.314 0-6 2.686-6 6s2.686 6 6 6z" />
        <path d="m97.198 176.73c0-3.314-2.686-6-6-6h-35.83c-3.314 0-6 2.686-6 6s2.686 6 6 6h35.83c3.314 0 6-2.686 6-6z" />
        <path d="m356.31 46.517c-2.343-2.343-6.142-2.344-8.485-1e-3l-27.96 27.96c-2.375 2.311-2.426 6.11-0.115 8.484 2.311 2.375 6.11 2.426 8.484 0.115 0.039-0.038 0.078-0.077 0.116-0.116l27.96-27.959c2.342-2.343 2.342-6.14 0-8.483z" />
        <path d="m95.887 46.517c-2.342 2.343-2.342 6.141 0 8.484l27.956 27.959c2.362 2.324 6.161 2.294 8.485-.068 2.298-2.335 2.298-6.081.001-8.416l-27.96-27.959c-2.343-2.341-6.139-2.341-8.482 0z" />
        <path d="m338.78 274.34c-9.132-3e-3 -18.231 1.095-27.1 3.269 48.365-47.265 49.256-124.79 1.992-173.15s-124.79-49.256-173.15-1.992-49.256 124.79-1.992 173.15c1.546 1.582 3.134 3.121 4.763 4.617 15.62 14.494 24.47 34.857 24.41 56.166v58.131c0.015 13.202 10.713 23.9 23.915 23.915h37.43c7.648 27.496 25.308 51.135 49.506 66.268v0.286h0.449c53.486 33.021 123.61 16.431 156.64-37.055s16.431-123.61-37.055-156.64c-17.972-11.096-38.679-16.972-59.801-16.97zm-187.37-2.94c-44.935-41.252-47.92-111.12-6.668-156.06 1.177-1.282 2.385-2.537 3.621-3.762 43.301-42.963 113.23-42.689 156.19 0.612s42.689 113.23-0.612 156.19c-0.842 0.836-1.698 1.658-2.567 2.466-4.965 4.628-9.404 9.789-13.237 15.39-19.72 9.853-36.18 25.184-47.408 44.155h-61.243c-1.46-22.536-11.511-43.653-28.08-58.999zm78.41 83.817h-16.985c-3.314 0-6 2.686-6 6s2.686 6 6 6h14.055c-0.84 4.501-1.408 9.049-1.7 13.618h-45.49v-13.622h14.59c3.314 0 6-2.686 6-6s-2.686-6-6-6h-14.59v-12.813h54.866c-1.839 4.171-3.424 8.45-4.746 12.813zm-38.205 51.236c-6.577-8e-3 -11.907-5.338-11.915-11.915v-1.7h45.352c0.184 4.563 0.642 9.11 1.372 13.618zm207.93 63.386v-12.527l13.81-13.1c1.194-1.133 1.87-2.707 1.87-4.353v-11.548c9.405-3.314 14.344-13.625 11.03-23.03s-13.625-14.344-23.03-11.03-14.344 13.625-11.03 23.03c1.817 5.157 5.873 9.213 11.03 11.03v8.968l-13.81 13.1c-1.194 1.133-1.87 2.706-1.87 4.352v22.81c-7.063 3.87-14.563 6.882-22.341 8.972v-46.722l20.5-28.11c0.749-1.027 1.153-2.264 1.153-3.535v-31.635c9.406-3.314 14.345-13.625 11.031-23.031s-13.625-14.345-23.031-11.031-14.345 13.625-11.031 23.031c1.817 5.158 5.873 9.214 11.031 11.031v29.679l-20.5 28.111c-0.749 1.027-1.153 2.264-1.153 3.535v51.138c-4.777 0.682-9.596 1.025-14.422 1.026h-0.331v-64.931l11.364-11.369c1.125-1.125 1.758-2.651 1.758-4.242v-79c9.406-3.314 14.345-13.625 11.031-23.031s-13.625-14.345-23.031-11.031-14.345 13.625-11.031 23.031c1.817 5.158 5.873 9.214 11.031 11.031v76.515l-11.365 11.366c-1.125 1.125-1.757 2.651-1.757 4.242v66.667c-1.95-0.236-3.883-0.526-5.8-0.869v-90.879c0-1.591-0.632-3.117-1.757-4.242l-16.526-16.527v-9.4c9.405-3.314 14.344-13.625 11.03-23.03s-13.625-14.344-23.03-11.03-14.344 13.625-11.03 23.03c1.817 5.157 5.873 9.213 11.03 11.03v11.881c0 1.591 0.633 3.117 1.758 4.242l16.525 16.526v85.46c-6.266-1.946-12.328-4.496-18.1-7.615v-43.952c0-2.447-1.486-4.648-3.755-5.564l-16.46-6.643v-13c9.406-3.314 14.345-13.625 11.031-23.031s-13.625-14.345-23.031-11.031-14.345 13.625-11.031 23.031c1.817 5.158 5.873 9.214 11.031 11.031v17.053c0 2.447 1.485 4.648 3.754 5.564l16.461 6.643v32.3c-45.344-33.265-55.136-96.99-21.872-142.34s96.99-55.137 142.34-21.872 55.136 96.99 21.872 142.34c-6.004 8.184-13.198 15.425-21.344 21.482zm9.68-52.478c-3.345-1e-3 -6.056-2.712-6.055-6.057s2.712-6.056 6.057-6.055c3.344 1e-3 6.055 2.712 6.055 6.056-6e-3 3.342-2.715 6.049-6.057 6.052zm-28.367-51.8c-3.345 1e-3 -6.057-2.711-6.058-6.056s2.711-6.057 6.056-6.058 6.057 2.711 6.058 6.056v1e-3c-5e-3 3.342-2.714 6.05-6.056 6.054zm-35.285-46.05c-3.345 1e-3 -6.057-2.711-6.058-6.056s2.711-6.057 6.056-6.058 6.057 2.711 6.058 6.056v1e-3c-6e-3 3.342-2.714 6.05-6.056 6.054zm-49.2 36.879c-3.345 0-6.057-2.712-6.057-6.057s2.712-6.057 6.057-6.057 6.057 2.712 6.057 6.057v1e-3c-6e-3 3.344-2.718 6.052-6.062 6.053zm-32.029 41.322c-3.345 1e-3 -6.057-2.711-6.058-6.056s2.711-6.057 6.056-6.058 6.057 2.711 6.058 6.056v1e-3c-5e-3 3.344-2.717 6.052-6.061 6.054z" />
      </svg>
      <span className={styles.iconText}>{text.toLowerCase() || "Icon"}</span>
    </animated.figure>
  );
};

export default SceneIcon;
